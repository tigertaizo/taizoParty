<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ†ãƒ¼ãƒã‚µã‚¤ã‚³ãƒ­ãƒˆãƒ¼ã‚¯</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --dice-size: 140px;
        }

        body {
            background: radial-gradient(circle, #2c3e50, #000000);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start; /* ä¸Šã‹ã‚‰é †ã«é…ç½® */
            color: white;
            font-family: 'sans-serif';
            overflow-x: hidden;
            overflow-y: auto; /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’è¨±å¯ */
            padding: 40px 20px;
        }

        /* 3Dã‚µã‚¤ã‚³ãƒ­ã®ã‚³ãƒ³ãƒ†ãƒŠ */
        .scene {
            width: var(--dice-size);
            height: var(--dice-size);
            perspective: 600px;
            margin: 40px 0;
            flex-shrink: 0;
        }

        .dice {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 2s cubic-bezier(0.2, 0.8, 0.3, 1);
        }

        /* å„é¢ã®è¨­å®š */
        .dice-face {
            position: absolute;
            width: var(--dice-size);
            height: var(--dice-size);
            border: 2px solid #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px;
            text-align: center;
            font-weight: bold;
            font-size: 1rem;
            background: rgba(255, 255, 255, 0.95);
            color: #333;
            border-radius: 12px;
            backface-visibility: hidden;
            box-shadow: inset 0 0 15px rgba(0,0,0,0.1);
        }

        .front  { transform: rotateY(0deg) translateZ(calc(var(--dice-size) / 2)); }
        .back   { transform: rotateY(180deg) translateZ(calc(var(--dice-size) / 2)); }
        .right  { transform: rotateY(90deg) translateZ(calc(var(--dice-size) / 2)); }
        .left   { transform: rotateY(-90deg) translateZ(calc(var(--dice-size) / 2)); }
        .top    { transform: rotateX(90deg) translateZ(calc(var(--dice-size) / 2)); }
        .bottom { transform: rotateX(-90deg) translateZ(calc(var(--dice-size) / 2)); }

        /* çµæœè¡¨ç¤ºã®ã‚¹ã‚¿ã‚¤ãƒ« */
        #result-display {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease-out;
            min-height: 100px;
        }

        #result-display.show {
            opacity: 1;
            transform: translateY(0);
        }
    </style>
</head>
<body>

    <div class="text-center mb-4">
        <h1 class="text-3xl font-bold mb-2">ğŸ² ã‚µã‚¤ã‚³ãƒ­ãƒˆãƒ¼ã‚¯</h1>
        <p class="text-gray-300 text-sm">å…¨åŠ›ã§ã‚„ã‚“ã­ã©ã€é§„ç›®ã ãŒã‚“ãªã„ï¼</p>
    </div>

    <!-- ã‚µã‚¤ã‚³ãƒ­æœ¬ä½“ -->
    <div class="scene">
        <div class="dice" id="dice">
            <div class="dice-face front" id="face-0">ãƒ†ãƒ¼ãƒ1</div>
            <div class="dice-face back" id="face-1">ãƒ†ãƒ¼ãƒ2</div>
            <div class="dice-face right" id="face-2">ãƒ†ãƒ¼ãƒ3</div>
            <div class="dice-face left" id="face-3">ãƒ†ãƒ¼ãƒ4</div>
            <div class="dice-face top" id="face-4">ãƒ†ãƒ¼ãƒ5</div>
            <div class="dice-face bottom" id="face-5">ãƒ†ãƒ¼ãƒ6</div>
        </div>
    </div>

    <!-- çµæœè¡¨ç¤ºã‚¨ãƒªã‚¢ -->
    <div id="result-display" class="mt-4 text-center bg-white/10 p-6 rounded-2xl backdrop-blur-md border border-white/20 max-w-xs w-full mx-auto">
        <p class="text-xs text-yellow-400 font-bold mb-1 uppercase tracking-widest">Selected Theme</p>
        <h2 id="result-text" class="text-xl font-bold">ã‚µã‚¤ã‚³ãƒ­ã‚’æŒ¯ã£ã¦ã­</h2>
    </div>

    <!-- æ“ä½œãƒ‘ãƒãƒ« -->
    <div class="mt-8 flex flex-col items-center gap-6 w-full">
        <button id="roll-btn" class="bg-red-600 hover:bg-red-500 active:scale-95 text-white font-bold py-5 px-16 rounded-full text-2xl shadow-[0_0_20px_rgba(220,38,38,0.5)] transition-all duration-200 z-10">
            ã‚µã‚¤ã‚³ãƒ­ã‚’æŒ¯ã‚‹ï¼
        </button>
        
        <button id="edit-btn" class="text-sm text-gray-400 underline hover:text-white transition-colors">
            ãƒ†ãƒ¼ãƒã‚’ç·¨é›†ã™ã‚‹
        </button>
    </div>

    <!-- ç·¨é›†ç”¨ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="edit-modal" class="fixed inset-0 bg-black/90 hidden items-center justify-center p-4 z-50">
        <div class="bg-slate-800 p-6 rounded-2xl w-full max-w-sm shadow-2xl border border-slate-700">
            <h3 class="text-xl font-bold mb-4 text-center">ãƒˆãƒ¼ã‚¯ãƒ†ãƒ¼ãƒã‚’ç·¨é›†</h3>
            <div id="input-container" class="space-y-3 mb-6">
                <!-- Inputs will be generated here -->
            </div>
            <div class="flex gap-3">
                <button id="save-btn" class="flex-1 bg-blue-600 hover:bg-blue-500 py-3 rounded-xl font-bold transition-colors">ä¿å­˜ã™ã‚‹</button>
                <button id="close-btn" class="flex-1 bg-gray-700 hover:bg-gray-600 py-3 rounded-xl transition-colors">é–‰ã˜ã‚‹</button>
            </div>
        </div>
    </div>

    <script>
        // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ†ãƒ¼ãƒ
        let themes = [
            "æœ€è¿‘ãƒãƒã£ã¦ã„ã‚‹ã“ã¨",
            "è¡Œã£ã¦ã¿ãŸã„æ—…è¡Œå…ˆ",
            "å®Ÿã¯è‡ªæ…¢ã—ãŸã„ã“ã¨",
            "æ˜¨æ—¥ã®æ™©ã”ã¯ã‚“",
            "åœ°å…ƒã®å¥½ããªã¨ã“ã‚",
            "æœ€è¿‘ã‚ã£ãŸå°ã•ãªå¹¸ã›"
        ];

        // è¦ç´ ã®å–å¾—
        const dice = document.getElementById('dice');
        const rollBtn = document.getElementById('roll-btn');
        const resultDisplay = document.getElementById('result-display');
        const resultText = document.getElementById('result-text');
        const editBtn = document.getElementById('edit-btn');
        const editModal = document.getElementById('edit-modal');
        const inputContainer = document.getElementById('input-container');
        const saveBtn = document.getElementById('save-btn');
        const closeBtn = document.getElementById('close-btn');

        // å„é¢ã®å›è»¢è§’åº¦ã®å®šç¾© [x, y]
        const rotations = [
            [0, 0],     // Front
            [0, 180],   // Back
            [0, -90],   // Right
            [0, 90],    // Left
            [-90, 0],   // Top
            [90, 0]     // Bottom
        ];

        // åˆæœŸè¡¨ç¤ºã®è¨­å®š
        function updateDiceFaces() {
            themes.forEach((theme, i) => {
                const face = document.getElementById(`face-${i}`);
                if (face) face.textContent = theme;
            });
        }

        // ã‚µã‚¤ã‚³ãƒ­ã‚’æŒ¯ã‚‹å‡¦ç†
        let isRolling = false;
        function rollDice() {
            if (isRolling) return;
            isRolling = true;
            
            // æ¼”å‡ºï¼šçµæœè¡¨ç¤ºã‚’éš ã™
            resultDisplay.classList.remove('show');
            rollBtn.disabled = true;
            rollBtn.classList.add('opacity-50', 'cursor-not-allowed');

            // ãƒ©ãƒ³ãƒ€ãƒ ãªç›®ã‚’é¸æŠ
            const resultIndex = Math.floor(Math.random() * 6);
            
            // æ´¾æ‰‹ã«å›è»¢ã•ã›ã‚‹ãŸã‚ã«ã€åŸºæœ¬ã®è§’åº¦ã«æ•°å›è»¢åˆ†(360 * n)ã‚’è¶³ã™
            const extraSpins = 5;
            const targetRotation = rotations[resultIndex];
            const x = targetRotation[0] + (360 * extraSpins);
            const y = targetRotation[1] + (360 * extraSpins);

            // é©ç”¨
            dice.style.transform = `rotateX(${x}deg) rotateY(${y}deg)`;

            // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®Œäº†å¾Œã®å‡¦ç†
            setTimeout(() => {
                isRolling = false;
                rollBtn.disabled = false;
                rollBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                
                // çµæœã‚’è¡¨ç¤º
                resultText.textContent = themes[resultIndex];
                resultDisplay.classList.add('show');
                
                // æ¬¡ã®å›è»¢ã®ãŸã‚ã«å›è»¢æ•°ã‚’ãƒªã‚»ãƒƒãƒˆï¼ˆè¦‹ãŸç›®ãŒå¤‰ã‚ã‚‰ãªã„ã‚ˆã†ã«ï¼‰
                setTimeout(() => {
                    dice.style.transition = 'none';
                    dice.style.transform = `rotateX(${targetRotation[0]}deg) rotateY(${targetRotation[1]}deg)`;
                    setTimeout(() => {
                        dice.style.transition = 'transform 2s cubic-bezier(0.2, 0.8, 0.3, 1)';
                    }, 50);
                }, 500);

            }, 2000);
        }

        // ç·¨é›†æ©Ÿèƒ½
        function openEditModal() {
            inputContainer.innerHTML = '';
            themes.forEach((theme, i) => {
                const div = document.createElement('div');
                div.className = 'flex items-center gap-2';
                const label = document.createElement('span');
                label.className = 'text-xs text-gray-400 w-4';
                label.textContent = i + 1;
                const input = document.createElement('input');
                input.type = 'text';
                input.value = theme;
                input.className = 'flex-1 bg-slate-700 border border-slate-600 p-2 rounded text-white text-sm focus:outline-none focus:border-blue-500';
                input.placeholder = `ãƒ†ãƒ¼ãƒ ${i + 1}`;
                div.appendChild(label);
                div.appendChild(input);
                inputContainer.appendChild(div);
            });
            editModal.classList.remove('hidden');
            editModal.classList.add('flex');
        }

        function saveThemes() {
            const inputs = inputContainer.querySelectorAll('input');
            const newThemes = Array.from(inputs).map(input => input.value.trim() || "ç„¡é¡Œã®ãƒ†ãƒ¼ãƒ");
            themes = newThemes;
            updateDiceFaces();
            editModal.classList.add('hidden');
            editModal.classList.remove('flex');
            resultDisplay.classList.remove('show');
            resultText.textContent = "ãƒ†ãƒ¼ãƒãŒæ›´æ–°ã•ã‚ŒãŸãï¼";
            resultDisplay.classList.add('show');
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        rollBtn.addEventListener('click', rollDice);
        editBtn.addEventListener('click', openEditModal);
        saveBtn.addEventListener('click', saveThemes);
        closeBtn.addEventListener('click', () => {
            editModal.classList.add('hidden');
            editModal.classList.remove('flex');
        });

        // åˆæœŸåŒ–
        window.onload = updateDiceFaces;

    </script>
</body>
</html>